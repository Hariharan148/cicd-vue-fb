# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Prod
on:
  pull_request:
    types: [closed]
    branches:
      - main
      
env:
  FIREBASE_TOKEN: 1//0gJU5IjREaV6iCgYIARAAGBASNwF-L9Ir7gum06JHNLeO4qgmmU9ucE__C_KZADWMgeoRTzCM2YyFkU2CxQs7mvbpQP92jQOObEw
  FIREBASE_PROJECT_ID: cicd-test-prod
  FIREBASE_ENVIRONMENT: cicd-test-prod

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - run: 'npm ci && npm run build:prod'
      - name: Install Firebase CLI
        run: |
          curl -sL https://firebase.tools | bash
          firebase --version

      - name: Firebase Login
        run: firebase login:ci --no-localhost --interactive
      
      - name: Firebase Use
        run: |
          firebase use --add ${{ env.FIREBASE_PROJECT_ID }}
          firebase use ${{ env.FIREBASE_ENVIRONMENT }}
      
      - name: Firebase Deploy
        run: |
          firebase deploy --only hosting --project ${{ env.FIREBASE_PROJECT_ID }} --message "Deployed from GitHub Actions"


