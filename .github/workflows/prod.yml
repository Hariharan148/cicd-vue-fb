# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Prod
on:
  pull_request:
    types: [closed]
    branches:
      - main
      
env:
  FIREBASE_PROJECT_ID: cicd-test-prod
  FIREBASE_ENVIRONMENT: cicd-test-prod

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

      - name: Install Firebase CLI
        run: |
          curl -sL https://firebase.tools | bash
          firebase --version

      - name: Firebase Login
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: '${{ secrets.GITHUB_TOKEN }}'
          firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT_CICD_TEST_PROD }}'

      - name: Firebase Use
        run: |
          firebase use --add ${{ env.FIREBASE_PROJECT_ID }}
          firebase use ${{ env.FIREBASE_ENVIRONMENT }}
      
      - name: Firebase Deploy
        run: |
          firebase deploy --only hosting --project ${{ env.FIREBASE_PROJECT_ID }} --message "Deployed from GitHub Actions"


